{
  "input": {
    "user_id": "latticeforge",
    "model_id": "latticeforge-briefing-3b",
    "run_id": "briefing-v1",
    "credentials": {
      "wandb_api_key": "",
      "hf_token": "${HF_TOKEN}"
    },
    "args": {
      "base_model": "Qwen/Qwen2.5-3B-Instruct",
      "model_type": "AutoModelForCausalLM",
      "tokenizer_type": "AutoTokenizer",
      "load_in_8bit": false,
      "load_in_4bit": true,
      "strict": false,
      "trust_remote_code": true,

      "datasets": [
        {
          "path": "${HF_DATASET_REPO}",
          "type": "sharegpt",
          "conversation": "chatml"
        }
      ],

      "dataset_prepared_path": "last_run_prepared",
      "val_set_size": 0.05,
      "output_dir": "./outputs/latticeforge-briefing-3b",

      "adapter": "qlora",
      "lora_r": 32,
      "lora_alpha": 64,
      "lora_dropout": 0.05,
      "lora_target_modules": [
        "q_proj",
        "k_proj",
        "v_proj",
        "o_proj",
        "gate_proj",
        "up_proj",
        "down_proj"
      ],

      "sequence_len": 2048,
      "sample_packing": true,
      "eval_sample_packing": false,
      "pad_to_sequence_len": true,

      "gradient_accumulation_steps": 4,
      "micro_batch_size": 2,
      "num_epochs": 3,
      "optimizer": "adamw_bnb_8bit",
      "lr_scheduler": "cosine",
      "learning_rate": 0.0002,
      "warmup_ratio": 0.1,
      "weight_decay": 0.01,
      "max_grad_norm": 1.0,

      "train_on_inputs": false,
      "group_by_length": false,
      "bf16": "auto",
      "tf32": true,
      "gradient_checkpointing": true,
      "flash_attention": true,

      "logging_steps": 10,
      "evals_per_epoch": 4,
      "saves_per_epoch": 1,

      "hub_model_id": "${HF_MODEL_REPO}",
      "push_to_hub": true,
      "special_tokens": {
        "pad_token": "<|endoftext|>"
      }
    }
  }
}
